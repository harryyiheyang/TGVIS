[{"path":"https://harryyiheyang.github.io/TGVIS/articles/Analysis.html","id":"load-outcome-gwas-data","dir":"Articles","previous_headings":"","what":"Load outcome GWAS data","title":"Analysis","text":"first step load GWAS summary data SBayesRC QC: GWAS summary dataset derived EUR-specific LDL-C GWAS GLGC consortium subsequently imputed using SBayesRC. imputed version available . Every GWAS summary data passed SBayesRC QC exactly 7,356,518 SNPs, A1 A2 alleles SNP consistent A1 A2 alleles SBayesRC LD matrix. SNP information file : , column Block necessary LD matrices stored block--block. next step 1) adding Z-score file 2) zoom target locus (PCSK9) region: demonstration purposes, consider region radius 0.5MB. However, practice, users can flexibly choose radius according specific situations. recommend excessively large radius (e.g., 1.5MB) point dimension LD matrix typically exceed 10 thousand, cause memory issues. next step estimating per-SNP heritability inflation factor using LDSC: found functions sometimes fail due subtle differences data.table data.frame. Therefore, encountering issues, can convert data.table data.frame, just performing LDSC. used different LDSC panels estimate inflation factor heritability GLGC lipids, obtained similar results: large inflation (exceeding 1.5) heritability less 0.1. slightly abnormal. However, still recommend using LDSC estimates evidence prove incorrect.","code":"library(data.table) library(arrow) library(ldscR) library(TGVIS) library(dplyr) library(glue) LDL=fread(glue(\"{filepath}/LDL.ma\"))%>%setDT(.) LDL #>                  SNP     A1     A2     freq             b          se         p #>               <char> <char> <char>    <num>         <num>       <num>     <num> #>       1:  rs12132974      T      C 0.079275 -0.0004260400 0.002584074 0.8690452 #>       2:  rs12134490      C      A 0.079225 -0.0004651126 0.002584819 0.8571996 #>       3:  rs17276806      T      C 0.079300 -0.0003976603 0.002583702 0.8776799 #>       4: rs139867617      T      C 0.079275 -0.0003797266 0.002584074 0.8831724 #>       5:   rs7526310      T      C 0.123250  0.0011156130 0.002123766 0.5993751 #>      ---                                                                        #> 7356514:  rs28729663      A      G 0.136000 -0.0007953800 0.002315470 0.7312171 #> 7356515:   rs9616832      C      T 0.073875 -0.0001726575 0.002668717 0.9484154 #> 7356516: rs147475742      A      G 0.041625  0.0022210817 0.003494952 0.5250949 #> 7356517: rs115055839      C      T 0.073975 -0.0001415992 0.002667057 0.9576587 #> 7356518:   rs9616985      C      T 0.073850 -0.0002142612 0.002669133 0.9360196 #>                N    r2 #>            <int> <int> #>       1: 1228642     1 #>       2: 1228642     1 #>       3: 1228642     1 #>       4: 1228642     1 #>       5: 1228642     1 #>      ---               #> 7356514: 1203805     1 #> 7356515: 1228648     0 #> 7356516: 1228648     0 #> 7356517: 1228648     0 #> 7356518: 1228648     0 V=fread(glue(\"{filepath}/ukbEUR_Imputed/snp.info\"))%>%   dplyr::select(SNP=ID,A1,A2,CHR=Chrom,BP=PhysPos,Freq=A1Freq,Block)%>%setDT(.) V #>                  SNP     A1     A2   CHR       BP     Freq Block #>               <char> <char> <char> <int>    <int>    <num> <int> #>       1:  rs12132974      T      C     1   801661 0.079275     1 #>       2:  rs12134490      C      A     1   801680 0.079225     1 #>       3:  rs17276806      T      C     1   801858 0.079300     1 #>       4: rs139867617      T      C     1   802856 0.079275     1 #>       5:   rs7526310      T      C     1   804759 0.123250     1 #>      ---                                                         #> 7356514:  rs28729663      A      G    22 51219006 0.137750   591 #> 7356515:   rs9616832      C      T    22 51219387 0.073875   591 #> 7356516: rs147475742      A      G    22 51219704 0.041625   591 #> 7356517: rs115055839      C      T    22 51221731 0.073975   591 #> 7356518:   rs9616985      C      T    22 51229805 0.073850   591 LDL$CHR=V$CHR LDL$BP=V$BP LDL$Block=V$Block LDL$Zscore=LDL$b/LDL$se LDL_Locus=LDL%>%dplyr::filter(CHR==1&abs(BP-55.5e6)<0.5e6)%>%arrange(BP) fitldsc=ldsc.univ(gwas=as.data.frame(LDL[,c(\"SNP\",\"Zscore\",\"N\")]),LDSC=as.data.frame(Hapmap3_EURLDSC),sampling.time=0) #> [1] \"Processing data\" #> Time difference of 4.571996 secs #> [1] \"Initial Heritability Estimate\" #> Time difference of 0.03129983 secs #> [1] \"Heritability Estimation (Reweighted)\" #> Time difference of 0.9223781 secs print(fitldsc) #>   intercept intercept.se         h2 h2.se       M #> 1  1.784062           NA 0.07295848    NA 1094541 var_inf=fitldsc$h2/fitldsc$M"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Analysis.html","id":"load-xqtl-direct-effect-data","dir":"Articles","previous_headings":"","what":"Load xQTL direct effect data","title":"Analysis","text":"utilize fine-mapping results eQTL data based v10 data published GTEx. Although GTEx also published fine-mapping results sQTL apaQTL, results contain credible sets causal xQTLs lack effect sizes, making temporarily unavailable. update provide sQTL apaQTL effect sizes. first examine data structure: found first column Ensemble ID, second column Symbol, fourth column crucial: provides CHR_BP_A2_A1_Build, use match GWAS summary data. Furthermore, gene may one multiple credible sets, indicated cs column. eQTLs within credible set gene, GTEx records afc afc_se corresponding eQTL maximum PIP. Since GTEx’s genotype data largely overlaps SBayesRC’s 7M SNP data portions still different, performed following QC process. First, SBayesRC’s build BP37, GTEx BP38, lab created correspondence file , can downloaded Dropbox: harmonize eQTL data: next step additional quality control. first impute afc afc_se set NA data afc afc_se xQTL maximum PIP credible set. imputation reasonable variants within credible set theoretically share single effect. , merge eQTL data V38. process may lose key SNPs, performed additional QC. merged data, retain eQTL maximum PIP within credible set. subsequent steps standard processing procedures: write QC process loop perform similar processing 50 GTEx tissues:","code":"path=glue(\"{filepath}/GTEx_v10_SuSiE_eQTL\") parquet_files=list.files(path=path,pattern=\"\\\\.parquet$\",full.names=F) Tissue=sapply(strsplit(basename(parquet_files),\"\\\\.\"),function(x) x[1])%>%sort() a=read_parquet(Sys.glob(glue(\"{path}/{Tissue[1]}*.parquet\"))[1]) colnames(a) #>  [1] \"phenotype_id\" \"gene_name\"    \"biotype\"      \"variant_id\"   \"pip\"          #>  [6] \"af\"           \"cs_id\"        \"cs_size\"      \"afc\"          \"afc_se\" head(a) #> # A tibble: 6 × 10 #>   phenotype_id   gene_name biotype variant_id    pip     af cs_id cs_size    afc #>   <chr>          <chr>     <chr>   <chr>       <dbl>  <dbl> <int>   <int>  <dbl> #> 1 ENSG000002272… WASH7P    unproc… chr1_6476… 0.993  0.0675     1       1  0.578 #> 2 ENSG000002689… ENSG0000… proces… chr1_1010… 0.952  0.0120     1       1  0.857 #> 3 ENSG000002794… WASH9P    unproc… chr1_5991… 0.999  0.0415     1       1 -0.615 #> 4 ENSG000002284… ENSG0000… transc… chr1_2851… 1      0.0169     1       1 -7.97  #> 5 ENSG000002284… ENSG0000… transc… chr1_2867… 1.000  0.165      2       1  1.06  #> 6 ENSG000002293… CICP3     proces… chr1_7300… 0.0344 0.0304     1       6 NA     #> # ℹ 1 more variable: afc_se <dbl> V38=read_parquet(glue(\"{filepath}/7M_BP_3738.parquet\")) V38=V38[which(V38$CHR==unique(LDL_Locus$CHR)),] # Reduce the size of V38 to improve computational efficiency   V38$MarkerName=paste0(\"chr\",V38$MarkerName) a$phenotype_id=sub(\"\\\\..*\",\"\",a$phenotype_id) # remove version subscript a=setDT(a) a[,c(\"CHR\",\"BP38\",\"A2\",\"A1\",\"Build\"):=tstrsplit(variant_id,\"_\",fixed=TRUE)] # Extract CHR and other information from the column variant_id a=a[which(a$CHR==paste0(\"chr\",unique(LDL_Locus$CHR))),] # Reduce the size of eQTL data to improve computational efficiency   a$MarkerName=paste0(a$CHR,\":\",a$BP38) a$CHR=NULL # Impute NA values with the first non-NA afc and afc_se within each credible set a[,c(\"afc\",\"afc_se\"):=.(na.omit(afc)[1],na.omit(afc_se)[1]),by=.(phenotype_id,cs_id)] # Merge eQTL data with V38 reference data a=merge(a,V38[,c(\"SNP\",\"MarkerName\",\"CHR\",\"BP\")],by=\"MarkerName\") # Keep only the eQTL with maximum PIP for each credible set a=a[a[,.I[which.max(pip)],by=.(phenotype_id,cs_id)]$V1] # Calculate Z-score a$Zscore=a$afc/a$afc_se # Remove missing values a=na.omit(a) # Harmonize alleles with reference panel a=TGVIS::allele_harmonise(ref_panel=LDL_Locus[,c(\"SNP\",\"A1\",\"A2\")],a) # Sort by gene name, base pair position, and absolute Z-score a=arrange(a,gene_name,BP,abs(Zscore)) # Select and rename columns a=dplyr::select(a,SNP,A1,A2,Zscore,Gene=phenotype_id,GeneSymbol=gene_name) # Add tissue information a$Tissue=Tissue[1] # Create a combined variable identifier a$Variable=paste0(a$GeneSymbol,\"*\",a$Tissue) a #> Key: <SNP> #>           SNP     A1     A2    Zscore            Gene GeneSymbol #>        <char> <char> <char>     <num>          <char>     <char> #> 1:   rs398038      T      A -2.167417 ENSG00000184313      MROH7 #> 2:   rs684473      G      C  5.398289 ENSG00000184313      MROH7 #> 3: rs45542642      A      G -2.408018 ENSG00000184313      MROH7 #> 4: rs34232196      T      C -4.084504 ENSG00000169174      PCSK9 #> 5: rs72907991      G      C  9.721504 ENSG00000243725       TTC4 #> 6:   rs683880      C      T  6.201287 ENSG00000162402      USP24 #>                  Tissue                   Variable #>                  <char>                     <char> #> 1: Adipose_Subcutaneous MROH7*Adipose_Subcutaneous #> 2: Adipose_Subcutaneous MROH7*Adipose_Subcutaneous #> 3: Adipose_Subcutaneous MROH7*Adipose_Subcutaneous #> 4: Adipose_Subcutaneous PCSK9*Adipose_Subcutaneous #> 5: Adipose_Subcutaneous  TTC4*Adipose_Subcutaneous #> 6: Adipose_Subcutaneous USP24*Adipose_Subcutaneous eQTL=list() for(i in 1:length(Tissue)){ a=read_parquet(Sys.glob(glue(\"{path}/{Tissue[i]}*.parquet\"))[1]) a$phenotype_id=sub(\"\\\\..*\",\"\",a$phenotype_id) a=setDT(a) a[,c(\"CHR\",\"BP38\",\"A2\",\"A1\",\"Build\"):=tstrsplit(variant_id,\"_\",fixed=TRUE)] a=a[which(a$CHR==paste0(\"chr\",unique(LDL_Locus$CHR))),] a$MarkerName=paste0(a$CHR,\":\",a$BP38) a$CHR=NULL setDT(a) a[,c(\"afc\",\"afc_se\"):=.(na.omit(afc)[1],na.omit(afc_se)[1]),by=.(phenotype_id,cs_id)] a=merge(a,V38[,c(\"SNP\",\"MarkerName\",\"CHR\",\"BP\")],by=\"MarkerName\") a=a[a[,.I[which.max(pip)],by=.(phenotype_id,cs_id)]$V1] a$Zscore=a$afc/a$afc_se a=na.omit(a) a=TGVIS::allele_harmonise(ref_panel=LDL_Locus[,c(\"SNP\",\"A1\",\"A2\")],a) a=arrange(a,gene_name,BP,abs(Zscore)) a=dplyr::select(a,SNP,A1,A2,Zscore,Gene=phenotype_id,GeneSymbol=gene_name) a$Tissue=Tissue[i] a$Variable=paste0(a$GeneSymbol,\"*\",a$Tissue) eQTL[[i]]=a } eQTL=do.call(rbind,eQTL) eQTL=merge(eQTL,LDL_Locus[,\"SNP\"],by=\"SNP\",all.y=T)"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Analysis.html","id":"load-ld-matrix","dir":"Articles","previous_headings":"","what":"Load LD matrix","title":"Analysis","text":"utilized readEig function SBayesRC write function called build_LD_matrix loading LD matrix. function can use block information GWAS_Locus locate blocks need read, extract LD matrix corresponding SNPs: also provide codes calculate LD matrix using European individuals UKBB:","code":"R=build_LD_matrix(GWAS_Locus=LDL_Locus,ldDir=glue(\"{filepath}/ukbEUR_Imputed/\"),snpinfo=V) R=cov2cor(R) library(BEDMatrix) EURIND=readRDS(glue(\"{filepath}/BED_file/UKBB_EURIND.rds)\") # The indices of EUR individuals SNPVec=LDL_Locus$SNP write.table(SNPVec,glue(\"{filepath}/BED_file/LDLSNP.txt\"),row.names=F,quote=F,sep=\"\\t\",col.names=F) setwd(\"~/Plink/\") system(glue(\"./plink --bfile {filepath}/UKB_Genotype_7M/7M_{Chr} --extract {filepath}/BED_file/LDLSNP.txt --make-bed --out {filepath}/BED_file/LDLSNP_Missing\"),intern=T) system(glue(\"./plink --bfile {filepath}/BED_file/LDLSNP_Missing --fill-missing-a2 --make-bed --out {filepath}/BED_file/LDLSNP\"),intern=T) # Imputate very few missing data using referance alleles system(glue(\"rm {filepath}/BED_file/LDLSNP_Missing*\")) geno=BEDMatrix(glue(\"{filepath}/BED_file/LDLSNP.bed\")) geno_bim=fread(glue(\"{filepath}/BED_file/LDLSNP.bim\"))%>%          dplyr::select(CHR=V1,SNP=V2,BP=V4,A1=V5,A2=V6)%>%mutate(MarkerName=paste0(SNP,\"_\",A1)) X=as.matrix(geno) X=X[EURIND,] R=cor(X) colnames(R)=rownames(R)=geno_bim$SNP R=R[LDL_Locus$SNP,LDL_Locus$SNP] R=cov2cor(R)"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Analysis.html","id":"perform-tgvis","dir":"Articles","previous_headings":"","what":"Perform TGVIS","title":"Analysis","text":"Next, use function make_design_matrix convert eQTL data m×pm\\times p matrix, mm number SNPs pp number gene-tissue pairs. align LD matrix, GWAS data, eQTL data, finally perform TGVIS: results, can see TGVIS first identified missense variant PCSK9, rs11591147, Pratt index 0.462. SNP PCSK9 variant initially reported NEJM. TGVIS also identified PCSK9-Whole_Blood gene-tissue pair, two causal eQTLs Pratt index 0.179. TGVIS additionally identified multiple credible sets Pratt indices exceeding 0.05. However, PCSK9 one significant loci LDL-C, even though Pratt index low, relative locus. Cross-loci comparison using Pratt indices valid.","code":"bXest=TGVIS::make_design_matrix(eQTL[,c(\"SNP\",\"Variable\",\"Zscore\")]) bXest=bXest[,!(colnames(bXest)==\"<NA>\")] bXest[is.na(bXest)]=0 bXest=as.matrix(bXest[LDL_Locus$SNP,]) by=LDL_Locus$Zscore R=R[LDL_Locus$SNP,LDL_Locus$SNP] t1 <- Sys.time() fit1=tgvis(estimate_inf=F,by=by,bXest=bXest,LD=R,L_vec=c(3:8),           Noutcome=mean(LDL_Locus$N),var_inf=var_inf,           residual_variance=fitldsc$intercept)  t2 <- Sys.time() print(difftime(t2, t1, units = \"secs\")) #> Time difference of 102.8224 secs # residual_variance is the inflaction factor fit1$Summary #>               variable cs   cs.logBF    cs.pratt    cs.pip                xqtl #> 1           rs11591147  1 509.513399 0.462411150 1.0000000          rs11591147 #> 2    PCSK9*Whole_Blood  2  87.770503 0.179166944 1.0000000 rs12117661~rs693668 #> 3            rs2479404  3  25.889077 0.047629044 0.9998935           rs2479404 #> 4            rs2495489  3  25.889077 0.047629044 0.9998935           rs2495489 #> 5            rs2495491  3  25.889077 0.047629044 0.9998935           rs2495491 #> 6          rs150119739  4  12.995401 0.020812107 0.9999856         rs150119739 #> 7           rs11206517  5  12.730242 0.035418442 0.9529990          rs11206517 #> 8             rs505151  5  12.730242 0.035418442 0.9529990            rs505151 #> 9           rs72911441  5  12.730242 0.035418442 0.9529990          rs72911441 #> 10 TMEM59*Artery_Aorta  6  13.431477 0.033762424 0.9999895          rs12732125 #> 11     TMEM59*Pancreas  6  13.431477 0.033762424 0.9999895          rs12732125 #> 12       TMEM59*Testis  6  13.431477 0.033762424 0.9999895          rs12732125 #> 13          rs12732125  6  13.431477 0.033762424 0.9999895          rs12732125 #> 14         rs115465289  7   6.489294 0.008102414 0.9837424         rs115465289 #> 15           rs2479411  8   7.261498 0.002927722 0.9841316           rs2479411 #> 16           rs2495479  8   7.261498 0.002927722 0.9841316           rs2495479 #> 17           rs2495480  8   7.261498 0.002927722 0.9841316           rs2495480 #> 18           rs2495481  8   7.261498 0.002927722 0.9841316           rs2495481 #> 19           rs2495482  8   7.261498 0.002927722 0.9841316           rs2495482 #> 20           rs4275490  8   7.261498 0.002927722 0.9841316           rs4275490 #>    type    estimate        pip        pratt #> 1   SNP -71.3590248 1.00000000 0.4624111497 #> 2  Gene   5.4854726 1.00000000 0.1791669445 #> 3   SNP  -7.7554503 0.37601913 0.0178352964 #> 4   SNP  -5.9112270 0.28715670 0.0136748475 #> 5   SNP  -6.9395350 0.33671763 0.0161189004 #> 6   SNP  13.3924307 0.99998556 0.0208121069 #> 7   SNP  16.0798824 0.83744389 0.0312175904 #> 8   SNP  -1.9671011 0.10371794 0.0037863256 #> 9   SNP   0.2191409 0.01183717 0.0004145257 #> 10 Gene   4.2205273 0.24999739 0.0084406060 #> 11 Gene   2.1536589 0.24999739 0.0084406060 #> 12 Gene   3.4831624 0.24999739 0.0084406060 #> 13  SNP  -3.1406787 0.24999739 0.0084406060 #> 14  SNP -10.3827277 0.98374239 0.0081024141 #> 15  SNP  -1.8953990 0.15220679 0.0004395556 #> 16  SNP  -1.6333809 0.13147026 0.0003729371 #> 17  SNP   1.5374061 0.12385232 0.0003775069 #> 18  SNP   2.0241300 0.16185945 0.0005098462 #> 19  SNP   2.1639230 0.17275606 0.0005432653 #> 20  SNP  -3.0409528 0.24198672 0.0006846112"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Analysis.html","id":"plot-tgivs-results","dir":"Articles","previous_headings":"","what":"Plot TGIVS results","title":"Analysis","text":"also created plot_tgvis function, can generate GWAS locus-zoom plots TGVIS Pratt index plots:   plot, circle square represents variant. Squares indicate causal xQTLs, circles indicate non-causal ones. single gene–tissue pair may multiple causal xQTLs, multiple signals pair can appear plot. mean multiple genes, rather multiple xQTLs associated one gene–tissue pair. variants gene–tissue pairs cs.pratt values exceeding threshold annotated.","code":"p1 <- plot_tgvis(gwas_df=LDL_Locus, summary_df=fit1$Summary,                   cs.pratt_thres = 0.1, y = \"z\") p2 <- plot_tgvis(gwas_df=LDL_Locus, summary_df=fit1$Summary,                   cs.pratt_thres = 0.1, y = \"cs.pratt\") p1 p2"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Analysis.html","id":"caveat-the-use-of-pratt-index","dir":"Articles","previous_headings":"","what":"Caveat: the use of Pratt index","title":"Analysis","text":"ongoing analysis, found Pratt index can affected many factors, largest influence LD mismatch. example, Pratt index may yield low values GWAS data largely based UK Biobank, LD mismatch, correctly measure contribution variable. issue affects TGVIS fine-mapping methods. Therefore, consider Pratt index measure causality non-causality, measure relative importance. can regard Pratt index less 0.05 relatively unimportant, PCSK9 example, rs2495491 less important relative rs11591147.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Data Preparation.html","id":"input-1-gwas-summary-data-for-tgvis","dir":"Articles","previous_headings":"","what":"Input 1: GWAS summary data for TGVIS","title":"Data Preparation","text":"section describes prepare GWAS summary statistics LD reference panels TGVIS analysis. TGVIS requires GWAS summary-level data single locus first input. strongly recommend performing quality control using SBayesRC prior running TGVIS. Although SBayesRC primarily designed polygenic prediction using functional annotations high-density SNPs (>7 million), two quality control functions highly effective preprocessing GWAS summary data.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Data Preparation.html","id":"quality-control-with-sbayesrc","dir":"Articles","previous_headings":"Input 1: GWAS summary data for TGVIS","what":"Quality Control with SBayesRC","title":"Data Preparation","text":"Run following two functions sequentially:","code":"SBayesRC::tidy(mafile = \"path/to/your_gwas.ma\",LDdir  = \"path/to/ld_folder\",                output = \"output_prefix_tidy.ma\",log2file = TRUE)  SBayesRC::impute(mafile = \"output_prefix_tidy.ma\",LDdir  = \"path/to/ld_folder\",                  output = \"output_prefix_imp.ma\",log2file = TRUE)"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Data Preparation.html","id":"input-format-gwas-summary-statistics","dir":"Articles","previous_headings":"Input 1: GWAS summary data for TGVIS","what":"Input Format: GWAS Summary Statistics","title":"Data Preparation","text":"input mafile must follow COJO format:","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Data Preparation.html","id":"ld-reference-panel","dir":"Articles","previous_headings":"Input 1: GWAS summary data for TGVIS","what":"LD Reference Panel","title":"Data Preparation","text":"LDdir contain precomputed eigen-decomposition files LD block. provide links SBayesRC LD panels multiple ancestries SNP sets: EUR, EAS, AFR suggest installing version SBayesRC, tests, current version incompatible BH R package installed properly.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Data Preparation.html","id":"input-2-xqtl-direct-effect-sizes","dir":"Articles","previous_headings":"","what":"Input 2: xQTL direct effect sizes","title":"Data Preparation","text":"second input TGVIS weights xQTL effect size (also known direct effects). marginal effects; instead, represent direct causal effect xQTL gene expression splicing, estimated accounting LD matrix nearby tagged variants. strongly recommend using precomputed weights official sources, generally derived individual-level data thus reliable fine-mapping summary statistics: GTEx v10 SuSiE eQTL weights PredictDB. weights typically estimated using fine-mapping methods SuSiE individual-level genotype expression data.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Data Preparation.html","id":"input-3-ld-matrix","dir":"Articles","previous_headings":"","what":"Input 3: LD Matrix","title":"Data Preparation","text":"strongly recommend using LD matrices provided SBayesRC input TGVIS. implemented function construct required LD matrix: GWAS_Locus: data frame containing GWAS summary data single locus (recommend fewer 10,000 SNPs avoid memory issues). ldDir: Path directory containing SBayesRC precomputed LD blocks. snpinfo: SNP annotation information, included ancestry-specific LD matrices provided SBayesRC.","code":"build_LD_matrix(GWAS_Locus, ldDir = \"path/to/ld_folder\", snpinfo)"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Data Preparation.html","id":"input-4-per-snp-heritability-and-inflation-factor","dir":"Articles","previous_headings":"","what":"Input 4: Per-SNP Heritability and Inflation Factor","title":"Data Preparation","text":"original TGVIS SuSiE-inf estimate infinitesimal effect current locus, variance estimated via REML. Motivated works Dr. Can Yang’s group, including MR-APSS XMAP, note variance infinitesimal effect can robustly estimated genome-wide using LDSC, rather locus-specific estimation. Dr. Yang also pointed GWAS, variance Z-scores 1, inflated due uncontrolled confounders. inflation factor precisely intercept estimated LDSC. developed R package ldscR, includes ancestry-specific LDSC weights derived LD matrices prodivded PRS-CSX (UK Biobank). Usage follows: addition, empirical observations show total heritability typically ranges 0.1 0.3 across traits. Hence, robust default set: per-SNP heritability = 0.2 / 1e6 inflation factor = 1.1 (slightly larger 1).","code":"devtools::install_github(\"harryyiheyang/ldscR\") ldscR::ldsc.univ(gwas = GWAS_Locus,LDSC = Hapmap3_EURLDSC,sampling.time = 0) # setting sampling.time = 0 disables standard error estimation via blockwise bootstrap."},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Introduction.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick Start","title":"Introduction","text":"","code":"# Install from GitHub devtools::install_github(\"harryyiheyang/TGVIS\")  # Load package library(TGVIS)"},{"path":"https://harryyiheyang.github.io/TGVIS/articles/Introduction.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"Introduction","text":"Yang, Y., Lorincz-Comi, N. Zhu, X., 2025. Uncovering causal gene-tissue pairs variants multivariate TWAS controlling infinitesimal effects. Nature Communications, 16(1), p.6098. https://doi.org/10.1038/s41467-025-61423-8","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yihe Yang. Maintainer.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Yang, Y., Lorincz-Comi, N., & Zhu, X. (2025). Uncovering causal gene-tissue pairs variants multivariate TWAS controlling infinitesimal effects. Nature Communications, 16(1), 6098. https://doi.org/10.1038/s41467-025-56098-7","code":"@Article{,   title = {Uncovering causal gene-tissue pairs and variants through a multivariate TWAS controlling for infinitesimal effects},   author = {Yihe Yang and Noah Lorincz-Comi and Xiaofeng Zhu},   journal = {Nature Communications},   volume = {16},   number = {1},   pages = {6098},   year = {2025},   publisher = {Nature Publishing Group UK London},   doi = {10.1038/s41467-025-56098-7}, }"},{"path":"https://harryyiheyang.github.io/TGVIS/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation:","title":"Tissue-Gene pairs, direct causal Variants, and Infinitesimal effects Selector (TGVIS)","text":"Run following R:","code":"install.packages(\"devtools\") devtools::install_github(\"harryyiheyang/TGVIS\")"},{"path":"https://harryyiheyang.github.io/TGVIS/index.html","id":"tutorials","dir":"","previous_headings":"","what":"Tutorials:","title":"Tissue-Gene pairs, direct causal Variants, and Infinitesimal effects Selector (TGVIS)","text":"Please visit online documentation: https://harryyiheyang.github.io/TGVIS/","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/index.html","id":"license","dir":"","previous_headings":"","what":"Tissue-Gene pairs, direct causal Variants, and Infinitesimal effects Selector (TGVIS)","title":"Tissue-Gene pairs, direct causal Variants, and Infinitesimal effects Selector (TGVIS)","text":"package licensed MIT License.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"Tissue-Gene pairs, direct causal Variants, and Infinitesimal effects Selector (TGVIS)","text":"questions issues, please contact Yihe Yang yxy1234@case.edu.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/allele_harmonise.html","id":null,"dir":"Reference","previous_headings":"","what":"allele_harmonise: Function to harmonize allele coding between a reference panel and GWAS/eQTL summary data — allele_harmonise","title":"allele_harmonise: Function to harmonize allele coding between a reference panel and GWAS/eQTL summary data — allele_harmonise","text":"function harmonizes allele coding LD reference panel GWAS/eQTL summary data ensure consistency effect allele (A1) allele (A2). Z-scores GWAS/eQTL summary data adjusted accordingly alleles flipped.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/allele_harmonise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"allele_harmonise: Function to harmonize allele coding between a reference panel and GWAS/eQTL summary data — allele_harmonise","text":"","code":"allele_harmonise(ref_panel, gwas_data)"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/allele_harmonise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"allele_harmonise: Function to harmonize allele coding between a reference panel and GWAS/eQTL summary data — allele_harmonise","text":"ref_panel data.frame data.table representing LD reference panel. must contain columns \"SNP\", \"A1\" (effect allele), \"A2\" (allele). gwas_data data.frame data.table representing GWAS/eQTL summary data. must contain columns \"SNP\", \"A1\", \"A2\", \"Zscore\".","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/allele_harmonise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"allele_harmonise: Function to harmonize allele coding between a reference panel and GWAS/eQTL summary data — allele_harmonise","text":"data.table harmonized alleles adjusted Z-scores. output contains harmonized alleles reference panel original alleles GWAS/eQTL data separate columns.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/build_LD_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Build Blockwise Linkage Disequilibrium (LD) Matrix — build_LD_matrix","title":"Build Blockwise Linkage Disequilibrium (LD) Matrix — build_LD_matrix","text":"function constructs genome-wide LD matrix combining block-level eigen-decomposed LD components stored specified directory. LD block reconstructed using eigenvectors (`U`) eigenvalues (`lambda`) `SBayesRC::readEig`, re-ordered match SNP order `GWAS_Locus`.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/build_LD_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build Blockwise Linkage Disequilibrium (LD) Matrix — build_LD_matrix","text":"","code":"build_LD_matrix(GWAS_Locus, ldDir, snpinfo)"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/build_LD_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build Blockwise Linkage Disequilibrium (LD) Matrix — build_LD_matrix","text":"GWAS_Locus data frame containing least two columns: Block Character integer ID indicating LD block assignment SNP. SNP SNP identifier, must unique. ldDir character string specifying directory path contains LD block eigen-decomposition files (compatible `SBayesRC::readEig`). snpinfo data frame columns: SNP SNP identifier. Block Block ID corresponding SNP. Used match order SNPs correctly within block.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/build_LD_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build Blockwise Linkage Disequilibrium (LD) Matrix — build_LD_matrix","text":"symmetric numeric matrix dimension \\(n_{SNP} \\times n_{SNP}\\),   block diagonal corresponds LD submatrix block.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/eQTLmapping_susie.html","id":null,"dir":"Reference","previous_headings":"","what":"eQTLmapping_susie: Function to perform eQTL fine-mapping using SuSiE and optional resampling — eQTLmapping_susie","title":"eQTLmapping_susie: Function to perform eQTL fine-mapping using SuSiE and optional resampling — eQTLmapping_susie","text":"function performs fine-mapping eQTLs using SuSiE (Sum Single Effects) algorithm. allows optional resampling eQTL effects returns estimated effects resampled effects.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/eQTLmapping_susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"eQTLmapping_susie: Function to perform eQTL fine-mapping using SuSiE and optional resampling — eQTLmapping_susie","text":"","code":"eQTLmapping_susie(   bX,   LD,   Nvec,   pip_thres = 0.5,   pip.min = 0.2,   L = 8,   coverage = 0.95,   max_iter = 300,   ... )"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/eQTLmapping_susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"eQTLmapping_susie: Function to perform eQTL fine-mapping using SuSiE and optional resampling — eQTLmapping_susie","text":"bX matrix Z-scores marginal eQTL effect estimates tissue-gene pairs. LD LD matrix variants. Nvec vector representing sample sizes tissue-gene pair eQTL studies. pip_thres threshold individual PIP credible set found. Default 0.2. pip.min minimum individual PIP 95% credible set. Used remove variables low PIPs within credible sets. Default 0.05. L number single effects used SuSiE model. Default 8. coverage coverage credible set used SuSiE. Default 0.95. max_iter maximum iterations SuSiE model. Default 300.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/eQTLmapping_susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"eQTLmapping_susie: Function to perform eQTL fine-mapping using SuSiE and optional resampling — eQTLmapping_susie","text":"matrix estimated eQTL effects tissue-gene pairs.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/filter_align.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter and Align GWAS Data to a Reference Panel — filter_align","title":"Filter and Align GWAS Data to a Reference Panel — filter_align","text":"filter_align function processes list GWAS summary statistics data frames, harmonizes alleles according reference panel, removes duplicates, aligns data common SNPs. used prepare data analysis LDSC.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/filter_align.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter and Align GWAS Data to a Reference Panel — filter_align","text":"","code":"filter_align(gwas_data_list, ref_panel, allele_match = TRUE)"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/filter_align.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter and Align GWAS Data to a Reference Panel — filter_align","text":"gwas_data_list list data.frames data.frame contains GWAS summary statistics trait. data.frame include columns SNP identifiers, Z-scores effect size estimates, sample sizes (N), effect allele (A1), reference allele (A2). ref_panel data.frame containing reference panel data. must include columns SNP, A1, A2. allele_match Logical. Whether match alleles. Default TRUE.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/filter_align.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter and Align GWAS Data to a Reference Panel — filter_align","text":"list data.frames, corresponding input GWAS summary statistics data frame, filtered, harmonized, aligned common SNPs found across data frames.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/filter_align.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter and Align GWAS Data to a Reference Panel — filter_align","text":"function performs several key steps: adjusting alleles according reference panel, removing duplicate SNPs, aligning GWAS data frames set common SNPs. often necessary preprocessing step performing genetic correlation heritability analyses.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/make_design_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"make_design_matrix: Constructs a Design Matrix of Z-scores for Gene-Tissue Pairs — make_design_matrix","title":"make_design_matrix: Constructs a Design Matrix of Z-scores for Gene-Tissue Pairs — make_design_matrix","text":"function constructs design matrix `data.table` row represents SNP, column represents tissue-gene pair, values z-scores. tissue-gene pair z-score SNP, corresponding entry `NA`.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/make_design_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make_design_matrix: Constructs a Design Matrix of Z-scores for Gene-Tissue Pairs — make_design_matrix","text":"","code":"make_design_matrix(df)"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/make_design_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"make_design_matrix: Constructs a Design Matrix of Z-scores for Gene-Tissue Pairs — make_design_matrix","text":"df `data.table` three columns: `SNP`, `Variable` (representing tissue-gene pairs), `Zscore`.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/make_design_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"make_design_matrix: Constructs a Design Matrix of Z-scores for Gene-Tissue Pairs — make_design_matrix","text":"matrix rows correspond SNPs, columns correspond tissue-gene pairs, values z-scores. Missing values (`NA`) indicate tissue-gene pair z-score SNP.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/modified_predixcan.html","id":null,"dir":"Reference","previous_headings":"","what":"modified_predixcan: Function to estimate causal effects using a modified PrediXcan approach with BIC-based tuning parameter selection — modified_predixcan","title":"modified_predixcan: Function to estimate causal effects using a modified PrediXcan approach with BIC-based tuning parameter selection — modified_predixcan","text":"function implements modified version PrediXcan method, using alternating direction method multipliers (ADMM) algorithm BIC selecting optimal tuning parameter. estimates causal effects tissue-gene pairs accounting direct causal variants.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/modified_predixcan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"modified_predixcan: Function to estimate causal effects using a modified PrediXcan approach with BIC-based tuning parameter selection — modified_predixcan","text":"","code":"modified_predixcan(   by,   bxest,   LD,   tauvec = seq(3, 10, by = 1),   rho.gamma = 1.5,   max.iter = 15,   max.eps = 0.005,   ebic.factor = 2,   normmax = 2,   pleiotropy.rm = NULL )"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/modified_predixcan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"modified_predixcan: Function to estimate causal effects using a modified PrediXcan approach with BIC-based tuning parameter selection — modified_predixcan","text":"vector Z-scores marginal effects outcome GWAS (ctwas). bxest vector direct xQTL effect estimates tissue-gene pair. LD LD matrix variants (ctwas). tauvec vector tuning parameters used penalizing direct causal effect. Default `seq(3,10,=1)`. rho.gamma parameter set ADMM algorithm. Default 1.5. max.iter maximum number iterations ADMM algorithm. Default 15. max.eps convergence tolerance ADMM algorithm. Default 0.005. ebic.factor extended BIC factor model selection. Default 2. pleiotropy.rm vector indices specifying variants considered direct causal effects.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/modified_predixcan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"modified_predixcan: Function to estimate causal effects using a modified PrediXcan approach with BIC-based tuning parameter selection — modified_predixcan","text":"list containing: theta estimated effect size tissue-gene pair. gamma estimated effect sizes direct causal variants. covtheta covariance estimated effect size `theta`. Bic BIC values tuning parameter. Btheta estimated `theta` values tuning parameter. Bgamma estimated `gamma` values tuning parameter. Eta estimated linear predictor tissue-gene pair.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/plot_tgvis.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GWAS Results with Credible-Set Annotation — plot_tgvis","title":"Plot GWAS Results with Credible-Set Annotation — plot_tgvis","text":"function visualizes GWAS results (Z-score, -log10(p), cs.pratt) fine-mapping annotations derived credible-set summary table. supports SNP/Gene distinction via shapes uses ggsci scientific color palettes.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/plot_tgvis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GWAS Results with Credible-Set Annotation — plot_tgvis","text":"","code":"plot_tgvis(   gwas_df,   summary_df,   cs.pratt_thres = 0.1,   y = c(\"z\", \"p\", \"cs.pratt\"),   palette = c(\"locuszoom\", \"npg\", \"lancet\", \"jco\", \"nejm\", \"d3\", \"ucscgb\", \"aaas\", \"igv\",     \"cosmic\", \"uchicago\", \"tron\", \"rickandmorty\", \"futurama\", \"simpsons\") )"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/plot_tgvis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GWAS Results with Credible-Set Annotation — plot_tgvis","text":"gwas_df data frame containing least: SNP, Zscore, p, CHR, BP. summary_df data frame fine-mapping summary, containing columns: variable, cs, cs.pip, cs.pratt, xqtl, type. cs.pratt_thres Numeric. Pratt index threshold labeling dashed line (default: 0.1). y Character. One \"z\", \"p\", \"cs.pratt\" determine y-axis variable. palette Character. ggsci color palette name. Default \"locuszoom\".","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/plot_tgvis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot GWAS Results with Credible-Set Annotation — plot_tgvis","text":"ggplot object.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/poet_shrinkage.html","id":null,"dir":"Reference","previous_headings":"","what":"poet_shrinkage: Function to perform covariance matrix shrinkage using the POET method — poet_shrinkage","title":"poet_shrinkage: Function to perform covariance matrix shrinkage using the POET method — poet_shrinkage","text":"function performs shrinkage covariance matrix using POET (Principal Orthogonal complEment Thresholding) method, automatic selection number latent factors optimal shrinkage parameter.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/poet_shrinkage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"poet_shrinkage: Function to perform covariance matrix shrinkage using the POET method — poet_shrinkage","text":"","code":"poet_shrinkage(   LD,   KMax = min(15, round(nrow(LD)/2)),   lamvec = seq(0.025, 0.25, by = 0.025),   minvalue = 0.001 )"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/poet_shrinkage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"poet_shrinkage: Function to perform covariance matrix shrinkage using the POET method — poet_shrinkage","text":"LD covariance matrix linkage disequilibrium (LD). KMax maximum number latent factors used POET. Default `min(15, round(nrow(LD)/2))`. lamvec vector candidate shrinkage parameters. Default `seq(0.025, 0.25, = 0.025)`. minvalue threshold minimum eigenvalues used determining optimal shrinkage parameter. Default `1e-3`.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/poet_shrinkage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"poet_shrinkage: Function to perform covariance matrix shrinkage using the POET method — poet_shrinkage","text":"covariance matrix shrunk using POET method.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/R2_partition.html","id":null,"dir":"Reference","previous_headings":"","what":"R2_partition: Function to partition the Pratt index contributions of tissue-gene pairs, direct causal variants, and infinitesimal effects — R2_partition","title":"R2_partition: Function to partition the Pratt index contributions of tissue-gene pairs, direct causal variants, and infinitesimal effects — R2_partition","text":"function partitions total Pratt index effects contributions tissue-gene pairs, direct causal variants, infinitesimal effects, using  vectors linear predictors outcome GWAS Z-scores.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/R2_partition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"R2_partition: Function to partition the Pratt index contributions of tissue-gene pairs, direct causal variants, and infinitesimal effects — R2_partition","text":"","code":"R2_partition(y, eta.theta, eta.gamma, eta.upsilon = NULL, LD)"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/R2_partition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"R2_partition: Function to partition the Pratt index contributions of tissue-gene pairs, direct causal variants, and infinitesimal effects — R2_partition","text":"y vector Z-scores marginal effects outcome GWAS. eta.theta vector linear predictor tissue-gene causal effects. eta.gamma vector linear predictor direct causal effects. eta.upsilon vector linear predictor infinitesimal effects. Default `NULL`. LD LD matrix.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/R2_partition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"R2_partition: Function to partition the Pratt index contributions of tissue-gene pairs, direct causal variants, and infinitesimal effects — R2_partition","text":"data frame containing: r1 Total Pratt index effects. r2 Pratt index contribution tissue-gene pairs. r3 Pratt index contribution direct causal variants. r4 Pratt index contribution infinitesimal effects.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/remove_missing_row_column.html","id":null,"dir":"Reference","previous_headings":"","what":"remove_missing_row_column: Removes Rows and Columns with Excessive Missing Values from a Matrix. — remove_missing_row_column","title":"remove_missing_row_column: Removes Rows and Columns with Excessive Missing Values from a Matrix. — remove_missing_row_column","text":"function processes matrix, typically output `make_design_matrix`, removing rows columns high percentage missing values (`NA`). function allows flexibility order operations, either removing rows first columns first.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/remove_missing_row_column.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"remove_missing_row_column: Removes Rows and Columns with Excessive Missing Values from a Matrix. — remove_missing_row_column","text":"","code":"remove_missing_row_column(M, rowthres = 0.95, colthres = 0.95, rowfirst = TRUE)"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/remove_missing_row_column.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"remove_missing_row_column: Removes Rows and Columns with Excessive Missing Values from a Matrix. — remove_missing_row_column","text":"M matrix, typically output `make_design_matrix`, rows represent SNPs, columns represent tissue-gene pairs, values z-scores. rowthres numeric threshold (0 1). Rows proportion missing values greater threshold removed. colthres numeric threshold (0 1). Columns proportion missing values greater threshold removed. rowfirst logical value. `TRUE`, rows processed columns. `FALSE`, columns processed rows.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/remove_missing_row_column.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"remove_missing_row_column: Removes Rows and Columns with Excessive Missing Values from a Matrix. — remove_missing_row_column","text":"matrix rows columns containing excessive missing values removed based specified thresholds.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/tgvis.html","id":null,"dir":"Reference","previous_headings":"","what":"tgvis: Function to estimate and select the optimal number of single effects using profile-likelihood and BIC — tgvis","title":"tgvis: Function to estimate and select the optimal number of single effects using profile-likelihood and BIC — tgvis","text":"function estimates number single effects locus combining profile-likelihood methods Bayesian Information Criterion (BIC) optimize model. includes resampling estimating standard errors performs score tests infinitesimal effects.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/tgvis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"tgvis: Function to estimate and select the optimal number of single effects using profile-likelihood and BIC — tgvis","text":"","code":"tgvis(   estimate_inf = F,   by,   bXest,   LD,   Noutcome,   L_vec = c(1:8),   var_inf = 1e-07,   estimate_residual_variance = F,   scaled_prior_variance = 0.5,   residual_variance = 1,   max_iter = 50,   max_eps = 0.001,   susie_iter = 500,   pip_thres_cred = 0.95,   eigen_thres = 0.999,   varinf_upper_boundary = 0.25,   varinf_lower_boundary = 0.001,   ebic_beta = 1,   ebic_upsilon = 1,   pip_min = 0.05,   pv_thres = 0.05,   pleiotropy_rm = NULL,   prior_weight_theta = NULL,   prior_weight_gamma = NULL,   standization = T )"},{"path":"https://harryyiheyang.github.io/TGVIS/reference/tgvis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"tgvis: Function to estimate and select the optimal number of single effects using profile-likelihood and BIC — tgvis","text":"estimate_inf indicator whether estimating infinitesimal effect. Default F. vector Z-scores marginal effects outcome GWAS. bXest matrix direct effect estimates based Z-scores tissue-gene pairs. LD LD matrix variants. Noutcome sample size outcome GWAS. L_vec vector candidate numbers single effects used BIC. Default `c(1:8)`. var_inf estimate_inf = F, variance infinitesimal effect (estimated LDSC possibly). Default 1e-7. estimate_residual_variance indicator whether estimating variance residuals SuSiE. Default F. scaled_prior_variance prior variance signals SuSiE. Default 0.5 slightly larger 0.2 SuSiE software. residual_variance residual variance.  Default 1. max_iter maximum number iterations profile-likelihood algorithm. Default 50. max_eps convergence tolerance profile-likelihood algorithm. Default 1e-3. susie_iter maximum number iterations `susie_rss` within profile-likelihood algorithm. Default 50. pip_thres_cred cumulative PIP threshold variables credible set. Default 0.95. eigen_thres threshold eigenvalues modelling infinitesimal effect. Default 1. varinf_upper_boundary upper boundary prior variance infinitesimal effects, multiplied var(y) adapt different locus variances. Default 0.25. varinf_lower_boundary lower boundary prior variance infinitesimal effects, multiplied var(y). Default 0.001. ebic_beta extended BIC factor causal effects tissue-gene pairs direct causal variants used BIC computation. Default 1. ebic_upsilon extended BIC factor infinitesimal effects used BIC computation. Default 1. pip_min minimum PIP threshold individual causal effects profile-likelihood. used specify tissue-gene pairs direct causal variants include score test variance infinitesimal effects. Default 0.05. pv_thres p-value threshold score test. Default 0.05. pleiotropy_rm vector indices specifying variants considered direct causal effects. prior_weight_theta vector prior weights gene-tissue pairs, used input SuSiE. Default NULL. prior_weight_gamma vector prior weights direct causal variants, used input SuSiE. Default NULL. standization indicator whether standardizing input performing SuSiE fine-mapping causal gene-tissue pairs direct causal variants. Default T.","code":""},{"path":"https://harryyiheyang.github.io/TGVIS/reference/tgvis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"tgvis: Function to estimate and select the optimal number of single effects using profile-likelihood and BIC — tgvis","text":"list containing: theta estimated effects tissue-gene pairs, scaled outcome GWAS sample size. gamma estimated effects direct causal variants, scaled outcome GWAS sample size. theta.pip Posterior inclusion probabilities (PIP) tissue-gene pairs. gamma.pip Posterior inclusion probabilities (PIP) direct causal variants. theta.pratt Pratt estimations tissue-gene pairs. gamma.pratt Pratt estimations direct causal variants. theta.cs Credible set indicators tissue-gene pairs. gamma.cs Credible set indicators direct causal variants. theta.cs.pip PIP within credible sets tissue-gene pairs. gamma.cs.pip PIP within credible sets direct causal variants. upsilon estimated infinitesimal effects. var.upsilon estimated variance infinitesimal effects. fit.causal SuSiE fit object causal analysis. cs.summary summary credible sets obtained analysis. Bicvec vector BIC values candidate number single effects.","code":""}]
